<UserControl
    x:Class="RibbonStyle.Views.Win11RibbonView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Fluent="urn:fluent-ribbon"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:local="clr-namespace:RibbonStyle.Views"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:prism="http://prismlibrary.com/"
    xmlns:vm="clr-namespace:RibbonStyle.ViewModels"
    d:DataContext="{d:DesignInstance Type=vm:RibbonViewModel,
                                     IsDesignTimeCreatable=True}"
    d:DesignHeight="1080" xmlns:view="clr-namespace:RibbonStyle.Views"
    d:DesignWidth="1600"
    prism:ViewModelLocator.AutoWireViewModel="True"
    mc:Ignorable="d">
    <Border Background="{StaticResource ActiveThemeBackground}">
        <Fluent:Ribbon Style="{StaticResource win11RibbonStyle}">
            <Fluent:Ribbon.Resources>
                <Style BasedOn="{StaticResource ribbonTabItemStyle}" TargetType="Fluent:RibbonTabItem" />
                <Style
                    x:Key="baseFluentButton"
                    BasedOn="{StaticResource Fluent.Ribbon.Styles.Button}"
                    TargetType="Fluent:Button">
                    <Setter Property="Margin" Value="1" />
                    <Setter Property="SimplifiedSizeDefinition" Value="Small" />
                </Style>
                <Style
                    x:Key="baseFluentComboBox"
                    BasedOn="{StaticResource MahApps.Styles.ComboBox}"
                    TargetType="Fluent:ComboBox">
                    <Setter Property="Margin" Value="1" />
                </Style>
                <Style
                    x:Key="baseFluentSplitButton"
                    BasedOn="{StaticResource Fluent.Ribbon.Styles.RibbonSplitButton}"
                    TargetType="Fluent:SplitButton">
                    <Setter Property="Margin" Value="1" />
                </Style>
                <Style
                    x:Key="baseFluentDropDownButton"
                    BasedOn="{StaticResource Fluent.Ribbon.Styles.RibbonDropDownButton}"
                    TargetType="Fluent:DropDownButton">
                    <Setter Property="Margin" Value="1" />
                </Style>
                <Style BasedOn="{StaticResource Fluent.Ribbon.Styles.RibbonGroupBox}" TargetType="Fluent:RibbonGroupBox">

                    <Setter Property="IsLauncherVisible" Value="True" />
                    <Setter Property="Icon" Value="{iconPacks:Material Kind=Launch}" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Fluent:RibbonGroupBox}">
                                <ControlTemplate.Resources>
                                    <ResourceDictionary>
                                        <Style BasedOn="{StaticResource Fluent.Ribbon.Styles.GroupBoxSeparator}" TargetType="Separator" />
                                        <Style
                                            x:Key="{x:Type ScrollBar}"
                                            BasedOn="{StaticResource Fluent.Ribbon.Styles.ScrollBarWhite}"
                                            TargetType="{x:Type ScrollBar}" />
                                        <Style
                                            x:Key="{x:Type ScrollViewer}"
                                            BasedOn="{StaticResource Fluent.Ribbon.Styles.ScrollViewer}"
                                            TargetType="{x:Type ScrollViewer}" />
                                    </ResourceDictionary>
                                </ControlTemplate.Resources>

                                <Grid x:Name="grid2" HorizontalAlignment="Stretch">
                                    <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" />

                                    <Grid>
                                        <ContentControl x:Name="nonCollapsedStateBorder" Focusable="False">
                                            <Grid x:Name="PART_ParentPanel" Height="Auto">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>

                                                <Fluent:RibbonGroupBoxWrapPanel
                                                    x:Name="PART_UpPanel"
                                                    Width="Auto"
                                                    Height="Auto"
                                                    Margin="4,0,4,0"
                                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                    VerticalAlignment="Stretch"
                                                    IsItemsHost="True" />

                                                <Grid
                                                    x:Name="PART_DownGrid"
                                                    Grid.Row="1"
                                                    Height="Auto"
                                                    MaxWidth="{Binding ActualWidth, ElementName=PART_ParentPanel}"
                                                    Margin="0"
                                                    VerticalAlignment="Bottom">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <ContentControl
                                                        x:Name="PART_HeaderContentControl"
                                                        Margin="2,0"
                                                        HorizontalAlignment="Stretch"
                                                        VerticalAlignment="Center"
                                                        Content="{TemplateBinding Header}"
                                                        ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                        ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                        ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                                        Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Header.Foreground}"
                                                        KeyboardNavigation.IsTabStop="False" />

                                                    <Fluent:Button
                                                        x:Name="PART_DialogLauncherButton"
                                                        Grid.Column="1"
                                                        Width="15"
                                                        Height="14"
                                                        Margin="0,0,1,1"
                                                        HorizontalAlignment="Stretch"
                                                        VerticalAlignment="Bottom"
                                                        Fluent:RibbonProperties.IconSize="Small"
                                                        Background="Transparent"
                                                        BorderBrush="Transparent"
                                                        Command="{Binding LauncherCommand, RelativeSource={RelativeSource TemplatedParent}}"
                                                        CommandParameter="{Binding LauncherCommandParameter, RelativeSource={RelativeSource TemplatedParent}}"
                                                        CommandTarget="{Binding LauncherCommandTarget, RelativeSource={RelativeSource TemplatedParent}}"
                                                        Header="{TemplateBinding LauncherText}"
                                                        Icon="{TemplateBinding LauncherIcon}"
                                                        IsEnabled="{Binding IsLauncherEnabled, RelativeSource={RelativeSource TemplatedParent}}"
                                                        Template="{DynamicResource Fluent.Ribbon.Templates.DialogLauncherButton}"
                                                        ToolTip="{Binding LauncherToolTip, RelativeSource={RelativeSource TemplatedParent}}"
                                                        Visibility="Visible" />
                                                </Grid>
                                            </Grid>
                                        </ContentControl>

                                        <Grid
                                            x:Name="collapsedStateGrid"
                                            Grid.RowSpan="2"
                                            Width="Auto"
                                            Height="Auto"
                                            Margin="0"
                                            Visibility="Collapsed">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <Border
                                                Grid.Row="0"
                                                Margin="5,3,5,0"
                                                Padding="4"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top"
                                                BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.Border}"
                                                BorderThickness="1">
                                                <Fluent:IconPresenter
                                                    x:Name="iconImage"
                                                    IconSize="{Binding Path=(Fluent:RibbonProperties.IconSize), RelativeSource={RelativeSource TemplatedParent}}"
                                                    MediumIcon="{Binding MediumIcon, RelativeSource={RelativeSource TemplatedParent}}"
                                                    SmallIcon="{Binding Icon, RelativeSource={RelativeSource TemplatedParent}}" />
                                            </Border>

                                            <ContentControl
                                                x:Name="PART_CollapsedHeaderContentControl"
                                                Grid.Row="1"
                                                Margin="5,0,5,0"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top"
                                                Fluent:RibbonGroupBox.IsCollapsedHeaderContentPresenter="True"
                                                Content="{TemplateBinding Header}"
                                                ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                                Foreground="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Header.Foreground}"
                                                KeyboardNavigation.IsTabStop="False"
                                                Style="{DynamicResource Fluent.Ribbon.Styles.RibbonGroupBox.TwoLineHeaderContentControl}" />

                                            <Popup
                                                x:Name="PART_Popup"
                                                Width="Auto"
                                                Height="{Binding ActualHeight, RelativeSource={RelativeSource TemplatedParent}}"
                                                AllowsTransparency="True"
                                                IsOpen="{TemplateBinding IsDropDownOpen}"
                                                PlacementTarget="{Binding ElementName=collapsedStateGrid, Mode=OneWay}">
                                                <Border
                                                    x:Name="border"
                                                    Height="Auto"
                                                    Background="{DynamicResource Fluent.Ribbon.Brushes.Ribbon.Background}"
                                                    BorderBrush="{DynamicResource Fluent.Ribbon.Brushes.RibbonTabItem.Border}"
                                                    BorderThickness="1"
                                                    d:LayoutOverrides="Width">
                                                    <ContentControl x:Name="popupContent" Focusable="False" />
                                                </Border>
                                            </Popup>
                                        </Grid>

                                        <Rectangle
                                            x:Name="separator"
                                            Grid.RowSpan="2"
                                            Width="1"
                                            Height="Auto"
                                            Margin="0,4"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Stretch"
                                            Fill="{DynamicResource Fluent.Ribbon.Brushes.GroupSeparator.Background}"
                                            Visibility="{Binding IsSeparatorVisible, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource Fluent.Ribbon.Converters.BoolToVisibilityConverter}}" />
                                    </Grid>

                                    <Image
                                        x:Name="PART_SnappedImage"
                                        Stretch="Uniform"
                                        Visibility="Collapsed" />
                                </Grid>

                                <ControlTemplate.Triggers>
                                    <Trigger Property="State" Value="Collapsed">
                                        <Setter TargetName="collapsedStateGrid" Property="Visibility" Value="Visible" />
                                        <Setter TargetName="grid2" Property="HorizontalAlignment" Value="Left" />
                                        <Setter TargetName="nonCollapsedStateBorder" Property="Content" Value="{x:Null}" />
                                        <Setter TargetName="nonCollapsedStateBorder" Property="UIElement.Visibility" Value="Collapsed" />
                                        <Setter TargetName="popupContent" Property="Content" Value="{Binding ElementName=PART_ParentPanel}" />
                                    </Trigger>
                                    <MultiTrigger>
                                        <MultiTrigger.Conditions>
                                            <Condition Property="State" Value="Collapsed" />
                                            <Condition Property="IsMouseOver" Value="True" />
                                        </MultiTrigger.Conditions>
                                        <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.Collapsed.MouseOver.Background}" />
                                    </MultiTrigger>
                                    <Trigger Property="IsDropDownOpen" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource Fluent.Ribbon.Brushes.RibbonGroupBox.DropDownOpen.Background}" />
                                    </Trigger>

                                    <Trigger Property="IsLauncherVisible" Value="False">
                                        <Setter TargetName="PART_DialogLauncherButton" Property="Visibility" Value="Collapsed" />
                                    </Trigger>
                                    <Trigger Property="LauncherToolTip" Value="{x:Null}">
                                        <Setter TargetName="PART_DialogLauncherButton" Property="ToolTip" Value="{Binding LauncherText, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>

                        </Setter.Value>
                    </Setter>
                </Style>
                <Style BasedOn="{StaticResource baseFluentButton}" TargetType="Fluent:Button" />
                <Style BasedOn="{StaticResource baseFluentDropDownButton}" TargetType="Fluent:DropDownButton" />
                <Style BasedOn="{StaticResource baseFluentSplitButton}" TargetType="Fluent:SplitButton" />
                <Style BasedOn="{StaticResource baseFluentComboBox}" TargetType="Fluent:ComboBox" />

            </Fluent:Ribbon.Resources>
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage Style="{StaticResource win11BackStageStyle}">
                    <Fluent:BackstageTabControl
                        Background="WhiteSmoke"
                        ItemsPanelMinWidth="140"
                        Template="{StaticResource backStageTemplate}">
                        <Fluent:BackstageTabItem Header="开始" Icon="{iconPacks:Codicons Kind=Home}">
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="新建" Icon="{iconPacks:Codicons Kind=File}" />
                        <Fluent:BackstageTabItem Header="打开" Icon="{iconPacks:Codicons Kind=FolderOpened}" />
                        <view:StartView/>
                        <Fluent:SeparatorTabItem />

                        <Fluent:BackstageTabItem Header="获取加载项">
                            <Fluent:BackstageTabItem.Icon>
                                <iconPacks:PackIconFeatherIcons BorderThickness="1" Kind="Grid" />
                            </Fluent:BackstageTabItem.Icon>
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="信息" />
                        <Fluent:BackstageTabItem Header="保存" />
                        <Fluent:BackstageTabItem Header="另存为" />
                        <Fluent:BackstageTabItem Header="历史记录" />
                        <Fluent:BackstageTabItem Header="打印" />
                        <Fluent:BackstageTabItem Header="共享" />
                        <Fluent:BackstageTabItem Header="导出" />
                        <Fluent:BackstageTabItem Header="发布" />
                        <Fluent:BackstageTabItem Header="关闭" />

                        <Fluent:SeparatorTabItem DockPanel.Dock="Bottom" Opacity="0" />
                        <Fluent:BackstageTabItem
                            VerticalAlignment="Bottom"
                            DockPanel.Dock="Bottom"
                            Header="选项" />
                        <Fluent:BackstageTabItem
                            VerticalAlignment="Bottom"
                            DockPanel.Dock="Bottom"
                            Header="账户" />
                        <Fluent:SeparatorTabItem DockPanel.Dock="Bottom" />
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>
            <Fluent:RibbonTabItem Header="开始">
                <Fluent:RibbonGroupBox Header="剪贴板">
                    <Fluent:SplitButton Header="粘贴">
                        <Fluent:SplitButton.Icon>
                            <iconPacks:PackIconZondicons
                                Width="30"
                                Height="30"
                                HorizontalAlignment="Center"
                                Kind="Paste" />
                        </Fluent:SplitButton.Icon>
                    </Fluent:SplitButton>

                    <Fluent:Button
                        Header="剪切"
                        Icon="{iconPacks:ForkAwesome Kind=Scissors,
                                                     RotationAngle=270}"
                        SizeDefinition="Middle,Small" />
                    <Fluent:SplitButton
                        HorizontalAlignment="Left"
                        Header="复制"
                        Icon="{iconPacks:Unicons Kind=FileCopyAlt}"
                        SizeDefinition="Middle,Small" />
                    <Fluent:Button
                        Header="格式刷"
                        Icon="{iconPacks:Modern Kind=DrawBrush}"
                        SizeDefinition="Middle,Small" />
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="字体">
                    <Fluent:RibbonToolBar>
                        <Fluent:RibbonToolBar.LayoutDefinitions>
                            <Fluent:RibbonToolBarLayoutDefinition>
                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlDefinition Width="120" Target="cbFontName" />
                                    <Fluent:RibbonToolBarControlDefinition Width="72" Target="cbFontSize" />
                                    <Fluent:RibbonToolBarControlDefinition Target="btGrowFont" />
                                    <Fluent:RibbonToolBarControlDefinition Target="btShrinkFont" />
                                </Fluent:RibbonToolBarRow>

                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btBold" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btItalic" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btUnderline" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>

                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btGridline" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>

                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btBackground" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btFontColor" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>

                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btPinyin" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                </Fluent:RibbonToolBarRow>
                            </Fluent:RibbonToolBarLayoutDefinition>
                        </Fluent:RibbonToolBar.LayoutDefinitions>
                        <Fluent:ComboBox x:Name="cbFontName" SizeDefinition="Small" />
                        <Fluent:ComboBox x:Name="cbFontSize" SizeDefinition="Small" />
                        <Fluent:Button
                            Name="btGrowFont"
                            Icon="{iconPacks:Material Kind=FormatFontSizeIncrease}"
                            SizeDefinition="Small" />
                        <Fluent:Button
                            Name="btShrinkFont"
                            Icon="{iconPacks:Material Kind=FormatFontSizeDecrease}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            Name="btChangeCase"
                            Icon="{iconPacks:Material Kind=FormatLetterCase}"
                            SizeDefinition="Small" />
                        <Fluent:Button
                            x:Name="btClearFormatting"
                            Icon="{iconPacks:Material Kind=FormatClear}"
                            SizeDefinition="Small" />
                        <Fluent:Button
                            x:Name="btBold"
                            Icon="{iconPacks:Material Kind=FormatBold}"
                            SizeDefinition="Small" />
                        <Fluent:Button
                            x:Name="btItalic"
                            Icon="{iconPacks:RadixIcons Kind=FontItalic}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            x:Name="btUnderline"
                            Icon="{iconPacks:Material Kind=FormatUnderline}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            x:Name="btGridline"
                            Icon="{iconPacks:Unicons Kind=Th}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            x:Name="btBackground"
                            Icon="{iconPacks:Ionicons Kind=ColorFillMD}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            x:Name="btFontColor"
                            Icon="{iconPacks:BoxIcons Kind=RegularFontColor}"
                            SizeDefinition="Small" />
                        <Fluent:DropDownButton
                            x:Name="btPinyin"
                            Icon="{iconPacks:RemixIcon Kind=PinyinInput}"
                            SizeDefinition="Small" />
                    </Fluent:RibbonToolBar>

                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="对齐方式">
                    <Fluent:RibbonToolBar>
                        <Fluent:RibbonToolBar.LayoutDefinitions>
                            <Fluent:RibbonToolBarLayoutDefinition>

                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignTop" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignVerticalCenter" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignBottom" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Width="120" Target="btDirection" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                </Fluent:RibbonToolBarRow>
                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignLeft" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignHorizontalCenter" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btAlignRight" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btDeindent" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btIndent" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                </Fluent:RibbonToolBarRow>
                            </Fluent:RibbonToolBarLayoutDefinition>
                        </Fluent:RibbonToolBar.LayoutDefinitions>
                        <Fluent:Button
                            x:Name="btAlignTop"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignTop}"
                            SizeDefinition="small" />
                        <Fluent:Button
                            x:Name="btAlignVerticalCenter"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignMiddle}"
                            SizeDefinition="small" />
                        <Fluent:Button
                            x:Name="btAlignBottom"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignBottom}"
                            SizeDefinition="small" />
                        <Fluent:Button
                            x:Name="btAlignLeft"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignLeft}"
                            SizeDefinition="small" />
                        <Fluent:Button
                            x:Name="btAlignHorizontalCenter"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignCenter}"
                            SizeDefinition="small" />
                        <Fluent:Button
                            x:Name="btAlignRight"
                            Icon="{iconPacks:MaterialLight Kind=FormatAlignRight}"
                            SizeDefinition="small" />
                        <Fluent:DropDownButton
                            x:Name="btDirection"
                            Icon="{iconPacks:RadixIcons Kind=ArrowBottomLeft,
                                                        RotationAngle=180}"
                            SizeDefinition="Middle,Small" />
                        <Fluent:Button
                            x:Name="btDeindent"
                            Icon="{iconPacks:VaadinIcons Kind=Deindent}"
                            SizeDefinition="Small" />
                        <Fluent:Button
                            x:Name="btIndent"
                            Icon="{iconPacks:VaadinIcons Kind=Indent}"
                            SizeDefinition="Small" />
                    </Fluent:RibbonToolBar>
                    <Separator />
                    <Fluent:Button
                        Margin="2,5"
                        Header="自动换行"
                        Icon="{iconPacks:Coolicons Kind=LineBreak}"
                        SizeDefinition="Middle,Small" />
                    <Fluent:SplitButton
                        x:Name="btCombineCenter"
                        Margin="2,5"
                        Header="合并后居中"
                        Icon="{iconPacks:Unicons Kind=AlignCenterH}"
                        SizeDefinition="Middle,Small" />
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="数字">
                    <Fluent:RibbonToolBar>
                        <Fluent:RibbonToolBar.LayoutDefinitions>
                            <Fluent:RibbonToolBarLayoutDefinition>
                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlDefinition Width="140" Target="cbDataFormat" />
                                </Fluent:RibbonToolBarRow>
                                <Fluent:RibbonToolBarRow>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btAccounting" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btPercent" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btComma" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                    <Fluent:RibbonToolBarControlGroupDefinition>
                                        <Fluent:RibbonToolBarControlDefinition Target="btDecimalDecrease" />
                                        <Fluent:RibbonToolBarControlDefinition Target="btDecimalIncrease" />
                                    </Fluent:RibbonToolBarControlGroupDefinition>
                                </Fluent:RibbonToolBarRow>
                            </Fluent:RibbonToolBarLayoutDefinition>
                        </Fluent:RibbonToolBar.LayoutDefinitions>
                        <Fluent:ComboBox Name="cbDataFormat" />

                        <Fluent:SplitButton
                            Name="btAccounting"
                            Icon="{iconPacks:BootstrapIcons Kind=ClipboardData}"
                            Size="Small" />
                        <Fluent:Button
                            Name="btPercent"
                            Icon="{iconPacks:BootstrapIcons Kind=Percent}"
                            Size="Small" />
                        <Fluent:Button
                            Name="btComma"
                            Icon="{iconPacks:Material Kind=Comma}"
                            Size="Small" />

                        <Fluent:Button
                            x:Name="btDecimalDecrease"
                            Icon="{iconPacks:Material Kind=DecimalDecrease}"
                            Size="Small" />
                        <Fluent:Button
                            x:Name="btDecimalIncrease"
                            Icon="{iconPacks:Material Kind=DecimalIncrease}"
                            Size="Small" />
                    </Fluent:RibbonToolBar>



                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="样式" IsLauncherVisible="False">
                    <Fluent:DropDownButton Header="条件格式">
                        <Fluent:DropDownButton.Icon>
                            <iconPacks:PackIconBootstrapIcons
                                Width="25"
                                Height="25"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="UiRadiosGrid" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>
                    <Fluent:DropDownButton Header="套用 表格格式">
                        <Fluent:DropDownButton.Icon>
                            <iconPacks:PackIconModern
                                Width="25"
                                Height="25"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="DrawPixelFillGrid" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>
                    <Fluent:InRibbonGallery
                        MinWidth="200"
                        ItemHeight="28"
                        ItemsSource="{Binding GridItemStyles}"
                        MaxItemsInRow="2">
                        <Fluent:InRibbonGallery.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Width="98"
                                    Margin="2"
                                    Background="{Binding Background}">
                                    <TextBlock
                                        x:Name="tb"
                                        Padding="5,0,0,0"
                                        VerticalAlignment="Center"
                                        Foreground="{Binding Foreground}"
                                        Text="{Binding Name}"
                                        TextAlignment="Left" />
                                </Border>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding IsUnderlined}" Value="True">
                                        <Setter TargetName="tb" Property="TextDecorations" Value="Underline" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </Fluent:InRibbonGallery.ItemTemplate>
                    </Fluent:InRibbonGallery>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="单元格" IsLauncherVisible="False">
                    <Fluent:SplitButton Header="插入">
                        <Fluent:SplitButton.Icon>
                            <Path
                                Width="30"
                                Height="30"
                                Data="M856.8832 166.912H391.3728v114.0736h465.5104V166.912m57.0368 0v114.0736a60.2112 60.2112 0 0 1-60.0064 60.1088H388.3008a60.2112 60.2112 0 0 1-60.0064-60.1088V166.912a60.1088 60.1088 0 0 1 60.0064-60.1088h468.5824c33.0752 0 57.0368 24.064 57.0368 60.1088zM625.5616 452.1984H160.0512v114.176h465.5104V452.1984m57.1392 0v114.176a60.2112 60.2112 0 0 1-60.1088 60.0064H157.0816a60.1088 60.1088 0 0 1-60.1088-60.0064V452.1984a60.3136 60.3136 0 0 1 60.1088-60.1088h468.48c33.0752 6.0416 57.1392 30.1056 57.1392 60.1088z m174.08 291.328H391.3728v114.176h465.5104V743.5264m57.0368 0v114.176a60.1088 60.1088 0 0 1-60.0064 60.0064H388.3008a60.1088 60.1088 0 0 1-60.0064-60.0064V743.5264a60.1088 60.1088 0 0 1 60.0064-60.0064h468.5824a61.44 61.44 0 0 1 57.0368 60.0064z m-126.1568-122.88l117.1456-87.1424 6.0416-6.0416a32.5632 32.5632 0 0 0-6.0416-41.984l-114.0736-87.3472a30.0032 30.0032 0 1 0-36.0448 48.0256l84.0704 63.0784-84.0704 63.0784A30.72 30.72 0 0 0 742.7072 593.92a27.0336 27.0336 0 0 0 27.0336 27.0336c6.0416 9.0112 12.0832 2.9696 18.0224 0z m0 0"
                                Fill="Black"
                                Stretch="Fill"
                                Stroke="Black"
                                StrokeThickness="0.1" />
                        </Fluent:SplitButton.Icon>
                    </Fluent:SplitButton>
                    <Fluent:SplitButton Header="删除">
                        <Fluent:SplitButton.Icon>
                            <Path
                                Width="30"
                                Height="30"
                                Data="M704.64 127.36l0 128a64 64 0 0 1-64 64l-512 0a64 64 0 0 1-64-64l0-128a64 64 0 0 1 64-64l512 0a64 64 0 0 1 64 64z m-76.8 12.8l-486.4 0 0 102.4 486.4 0 0-102.4z m76.8 627.2l0 128a64 64 0 0 1-64 64l-512 0a64 64 0 0 1-64-64l0-128a64 64 0 0 1 64-64l512 0a64 64 0 0 1 64 64z m-563.2 12.8l0 102.4 486.4 0 0-102.4-486.4 0zM960.64 447.36l0 128a64 64 0 0 1-64 64l-384 0a64 64 0 0 1-64-64l0-128a64 64 0 0 1 64-64l384 0a64 64 0 0 1 64 64z m-76.8 12.8l-358.4 0 0 102.4 358.4 0 0-102.4z m-678.592 99.648l-86.08 77.952a31.616 31.616 0 0 1-47.488-5.76l-1.792-2.688a38.4 38.4 0 0 1 6.08-49.92l77.44-70.08-74.624-72.512a38.4 38.4 0 0 1-4.352-50.048l1.792-2.56a31.36 31.36 0 0 1 47.36-4.032l83.2 80.832 78.592-71.168a31.616 31.616 0 0 1 47.488 5.76000001l1.792 2.68799999a38.4 38.4 0 0 1-6.08 49.92l-69.888 63.296 68.928 67.008a38.4 38.4 0 0 1 4.352 50.048l-1.856 2.56a31.36 31.36 0 0 1-47.36 4.096l-77.43999999-75.392z"
                                Fill="Black"
                                Stretch="Fill"
                                Stroke="Black"
                                StrokeThickness="0.1" />
                        </Fluent:SplitButton.Icon>
                    </Fluent:SplitButton>
                    <Fluent:DropDownButton Header="格式">
                        <Fluent:DropDownButton.Icon>
                            <Path
                                Width="30"
                                Height="30"
                                Data="M128 128h768v768H128V128z m64 512v128h128v-128H192z m256 0v128h192v-128H448zM192 448v128h128V448H192z m0-192v128h128V256H192z m192 0v128h192V256H384z m320 384v128h128v-128h-128z m0-192v128h128V448h-128z m0-192v128h128V256h-128z"
                                Fill="Black"
                                Stretch="Fill"
                                Stroke="Black"
                                StrokeThickness="0.1" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="编辑" IsLauncherVisible="False">
                    <Fluent:SplitButton
                        Header="自动求和"
                        Icon="{iconPacks:Material Kind=Sigma}"
                        Size="Middle" />
                    <Fluent:DropDownButton
                        Header="填充"
                        Icon="{iconPacks:BoxIcons Kind=RegularTable}"
                        Size="Middle" />
                    <Fluent:DropDownButton Header="清除" Size="Middle">
                        <Fluent:DropDownButton.Icon>
                            <iconPacks:PackIconBoxIcons Foreground="Purple" Kind="SolidEraser" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>
                    <Fluent:DropDownButton Header="排序和筛选">
                        <Fluent:DropDownButton.Icon>
                            <Path
                                Width="30"
                                Height="30"
                                Data="M938.666667 85.333333a42.666667 42.666667 0 0 1 39.936 57.642667L853.333333 477.013333V938.666667a42.666667 42.666667 0 0 1-64.341333 36.736L785.066667 972.8l-170.666667-128a42.666667 42.666667 0 0 1-17.066667-34.133333v-333.525334l-125.269333-334.165333a42.666667 42.666667 0 0 1 35.072-57.386667L512 85.333333zM426.666667 597.333333c37.973333 0 56.32 45.226667 31.274666 71.722667l-3.498666 3.328L243.285333 853.333333H426.666667a42.666667 42.666667 0 0 1 42.368 37.674667L469.333333 896a42.666667 42.666667 0 0 1-37.674666 42.368L426.666667 938.666667H128c-37.973333 0-56.32-45.226667-31.274667-71.722667l3.498667-3.328L311.296 682.666667H128a42.666667 42.666667 0 0 1-42.368-37.674667L85.333333 640a42.666667 42.666667 0 0 1 37.674667-42.368L128 597.333333h298.666667zM877.056 170.666667h-303.488l106.368 283.690666a42.666667 42.666667 0 0 1 2.432 9.898667L682.666667 469.333333v320l85.333333 64v-384a42.666667 42.666667 0 0 1 1.194667-10.112l1.536-4.864L877.056 170.666667zM313.941333 106.026667l2.474667 4.864 149.333333 341.333333a42.666667 42.666667 0 0 1-75.946666 38.656l-2.218667-4.437333L361.386667 426.666667H193.237333l-26.154666 59.733333a42.666667 42.666667 0 0 1-51.498667 23.765333l-4.693333-1.706666a42.666667 42.666667 0 0 1-23.722667-51.541334l1.706667-4.693333 149.333333-341.333333c14.208-32.384 58.538667-34.005333 75.733333-4.864zM277.333333 234.453333L230.570667 341.333333h93.525333L277.333333 234.453333z"
                                Fill="Black"
                                Stretch="Fill"
                                Stroke="Black"
                                StrokeThickness="0.1" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>
                    <Fluent:DropDownButton Header="查找和选择">
                        <Fluent:DropDownButton.Icon>

                            <Path
                                Width="30"
                                Height="30"
                                Data="M1012.755341 958.452019l-288.022-288.022c58.904864-70.987913 94.462819-161.943576 94.462819-260.83514 0-225.277184-184.317696-409.59488-409.59488-409.59488s-409.59488 184.317696-409.59488 409.59488 184.317696 409.59488 409.59488 409.59488c98.891564 0 189.847227-35.557956 260.83514-94.462819l288.022 288.022c15.001412 15.001412 39.295509 15.001412 54.296921 0C1027.731153 997.747528 1027.731153 973.427832 1012.755341 958.452019zM76.80544 409.59488c0-183.498506 149.297334-332.79584 332.79584-332.79584s332.79584 149.297334 332.79584 332.79584-149.297334 332.79584-332.79584 332.79584S76.80544 593.093386 76.80544 409.59488z"
                                Fill="Black"
                                Stretch="Fill"
                                Stroke="Black"
                                StrokeThickness="0.1" />
                        </Fluent:DropDownButton.Icon>
                    </Fluent:DropDownButton>

                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="加载项" IsLauncherVisible="False">
                    <Fluent:Button Header="加 载项">
                        <Fluent:Button.Icon>
                            <Path
                                Width="30"
                                Height="30"
                                Data="M416 32H32A32 32 0 0 0 0 64v384a32 32 0 0 0 32 32h384a32 32 0 0 0 32-32V64a32 32 0 0 0-32-32zm-32 64v128H256V96zm-192 0v128H64V96zM64 416V288h128v128zm192 0V288h128v128z"
                                Stretch="Fill"
                                Stroke="#FFE06538"
                                StrokeThickness="2" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem Header="插入" />
            <Fluent:RibbonTabItem Header="绘图" />
            <Fluent:RibbonTabItem Header="页面布局" />
            <Fluent:RibbonTabItem Header="公式" />
            <Fluent:RibbonTabItem Header="数据" />
            <Fluent:RibbonTabItem Header="审阅" />
            <Fluent:RibbonTabItem Header="视图" />
            <Fluent:RibbonTabItem Header="帮助" />
        </Fluent:Ribbon>
    </Border>
</UserControl>
